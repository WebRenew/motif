echo "ğŸ” Running pre-commit checks..."

# Run ESLint
echo "ğŸ“ Linting code..."
pnpm lint || {
  echo "âŒ Linting failed. Please fix errors before committing."
  exit 1
}

# Run TypeScript type checking
echo "ğŸ”§ Type checking..."
pnpm exec tsc --noEmit || {
  echo "âŒ Type checking failed. Please fix type errors before committing."
  exit 1
}

# Check if Supabase-related files were modified
if git diff --cached --name-only | grep -qE "(supabase/migrations|lib/supabase/)" ; then
  echo "ğŸ—„ï¸  Supabase files modified - reminder to sync types if schema changed"
  echo "   Run: pnpm db:types (or scripts/check-db-types.sh)"
fi

echo "âœ… Pre-commit checks passed!"
