{
  "markdown": "[Vercel](https://vercel.com/) Slash [Workflow DevKit LogoWorkflow](https://useworkflow.dev/)\n\n- [Docs](https://useworkflow.dev/docs)\n- [Examples](https://github.com/vercel/workflow-examples)\n\n[X](https://x.com/workflowdevkit) [GitHub](https://github.com/vercel/workflow) Search... `⌘K`Ask AI\n\nAsk AI\n\nSearch... `⌘K`\n\n[Getting Started](https://useworkflow.dev/docs/getting-started)\n\n- [Next.js](https://useworkflow.dev/docs/getting-started/next)\n- [Vite](https://useworkflow.dev/docs/getting-started/vite)\n- [Astro](https://useworkflow.dev/docs/getting-started/astro)\n- [Express](https://useworkflow.dev/docs/getting-started/express)\n- [Fastify](https://useworkflow.dev/docs/getting-started/fastify)\n- [Hono](https://useworkflow.dev/docs/getting-started/hono)\n- [Nitro](https://useworkflow.dev/docs/getting-started/nitro)\n- [Nuxt](https://useworkflow.dev/docs/getting-started/nuxt)\n- [SvelteKit](https://useworkflow.dev/docs/getting-started/sveltekit)\n\n[Foundations](https://useworkflow.dev/docs/foundations)\n\n- [Workflows and Steps](https://useworkflow.dev/docs/foundations/workflows-and-steps)\n- [Starting Workflows](https://useworkflow.dev/docs/foundations/starting-workflows)\n- [Control Flow Patterns](https://useworkflow.dev/docs/foundations/control-flow-patterns)\n- [Errors & Retrying](https://useworkflow.dev/docs/foundations/errors-and-retries)\n- [Hooks & Webhooks](https://useworkflow.dev/docs/foundations/hooks)\n- [Streaming](https://useworkflow.dev/docs/foundations/streaming)\n- [Serialization](https://useworkflow.dev/docs/foundations/serialization)\n- [Idempotency](https://useworkflow.dev/docs/foundations/idempotency)\n\nHow it works\n\n[Observability](https://useworkflow.dev/docs/observability)\n\nAI Agents\n\n- [Building Durable AI Agents](https://useworkflow.dev/docs/ai)\n- [Streaming Updates from Tools](https://useworkflow.dev/docs/ai/streaming-updates-from-tools)\n- [Resumable Streams](https://useworkflow.dev/docs/ai/resumable-streams)\n- [Sleep, Suspense, and Scheduling](https://useworkflow.dev/docs/ai/sleep-and-delays)\n- [Human-in-the-Loop](https://useworkflow.dev/docs/ai/human-in-the-loop)\n- [Patterns for Defining Tools](https://useworkflow.dev/docs/ai/defining-tools)\n- [Chat Session Modeling](https://useworkflow.dev/docs/ai/chat-session-modeling)\n\n[Deploying](https://useworkflow.dev/docs/deploying)\n\n[Errors](https://useworkflow.dev/docs/errors)\n\n[API Reference](https://useworkflow.dev/docs/api-reference)\n\nStreamingGetting Started with `getWritable()`\n\n[Foundations](https://useworkflow.dev/docs/foundations)\n\n# Streaming\n\nWorkflows can stream data in real-time to clients without waiting for the entire workflow to complete. This enables progress updates, AI-generated content, log messages, and other incremental data to be delivered as workflows execute.\n\n## [Getting Started with `getWritable()`](https://useworkflow.dev/docs/foundations/streaming\\#getting-started-with-getwritable)\n\nEvery workflow run has a default writable stream that steps can write to using [`getWritable()`](https://useworkflow.dev/docs/api-reference/workflow/get-writable). Data written to this stream becomes immediately available to clients consuming the workflow's output.\n\nworkflows/simple-streaming.ts\n\n```\n\n```\n\n### [Consuming the Stream](https://useworkflow.dev/docs/foundations/streaming\\#consuming-the-stream)\n\nUse the `Run` object's `readable` property to consume the stream from your API route:\n\napp/api/stream/route.ts\n\n```\n\n```\n\nWhen a client makes a request to this endpoint, they'll receive each message as it's written, without waiting for the workflow to complete.\n\n### [Resuming Streams from a Specific Point](https://useworkflow.dev/docs/foundations/streaming\\#resuming-streams-from-a-specific-point)\n\nUse `run.getReadable({ startIndex })` to resume a stream from a specific position. This is useful for reconnecting after timeouts or network interruptions:\n\napp/api/resume-stream/\\[runId\\]/route.ts\n\n```\n\n```\n\nThis allows clients to reconnect and continue receiving data from where they left off, rather than restarting from the beginning.\n\n## [Streams as Data Types](https://useworkflow.dev/docs/foundations/streaming\\#streams-as-data-types)\n\n[`ReadableStream`](https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream) and [`WritableStream`](https://developer.mozilla.org/en-US/docs/Web/API/WritableStream) are standard Web Streams API types that Workflow DevKit makes serializable. These are not custom types - they follow the web standard - but Workflow DevKit adds the ability to pass them between functions while maintaining their streaming capabilities.\n\nUnlike regular values that are fully serialized to the [event log](https://useworkflow.dev/docs/how-it-works/event-sourcing), streams maintain their streaming capabilities when passed between functions.\n\n**Key properties:**\n\n- Stream references can be passed between workflow and step functions\n- Stream data flows directly without being stored in the event log\n- Streams preserve their state across workflow suspension points\n\n**How Streams Persist Across Workflow Suspensions**\n\nStreams in Workflow DevKit are backed by persistent, resumable storage provided by the \"world\" implementation. This is what enables streams to maintain their state even when workflows suspend and resume:\n\n- **Vercel deployments**: Streams are backed by a performant Redis-based stream\n- **Local development**: Stream chunks are stored in the filesystem\n\n### [Passing Streams as Arguments](https://useworkflow.dev/docs/foundations/streaming\\#passing-streams-as-arguments)\n\nSince streams are serializable data types, you don't need to use the special [`getWritable()`](https://useworkflow.dev/docs/api-reference/workflow/get-writable). You can even wire your own streams through workflows, passing them as arguments from outside into steps.\n\nHere's an example of passing a request body stream through a workflow to a step that processes it:\n\napp/api/upload/route.ts\n\n```\n\n```\n\nworkflows/streaming.ts\n\n```\n\n```\n\n## [Important Limitation](https://useworkflow.dev/docs/foundations/streaming\\#important-limitation)\n\n**Streams Cannot Be Used Directly in Workflow Context**\n\nYou cannot read from or write to streams directly within a workflow function. All stream operations must happen in step functions.\n\nWorkflow functions must be deterministic to support replay. Since streams bypass the [event log](https://useworkflow.dev/docs/how-it-works/event-sourcing) for performance, reading stream data in a workflow would break determinism - each replay could see different data. By requiring all stream operations to happen in steps, the framework ensures consistent behavior.\n\nFor more on determinism and replay, see [Workflows and Steps](https://useworkflow.dev/docs/foundations/workflows-and-steps).\n\nworkflows/bad-example.ts\n\n```\n\n```\n\nworkflows/good-example.ts\n\n```\n\n```\n\n## [Namespaced Streams](https://useworkflow.dev/docs/foundations/streaming\\#namespaced-streams)\n\nUse `getWritable({ namespace: 'name' })` to create multiple independent streams for different types of data. This is useful when you want to separate logs, metrics, data outputs, or other distinct channels.\n\nworkflows/multi-stream.ts\n\n```\n\n```\n\n### [Consuming Namespaced Streams](https://useworkflow.dev/docs/foundations/streaming\\#consuming-namespaced-streams)\n\nUse `run.getReadable({ namespace: 'name' })` to access specific streams:\n\napp/api/multi-stream/route.ts\n\n```\n\n```\n\n## [Common Patterns](https://useworkflow.dev/docs/foundations/streaming\\#common-patterns)\n\n### [Progress Updates for Long-Running Tasks](https://useworkflow.dev/docs/foundations/streaming\\#progress-updates-for-long-running-tasks)\n\nSend incremental progress updates to keep users informed during lengthy workflows:\n\nworkflows/batch-processing.ts\n\n```\n\n```\n\n### [Streaming AI Responses with `DurableAgent`](https://useworkflow.dev/docs/foundations/streaming\\#streaming-ai-responses-with-durableagent)\n\nStream AI-generated content using [`DurableAgent`](https://useworkflow.dev/docs/api-reference/workflow-ai/durable-agent) from `@workflow/ai`. Tools can also emit progress updates to the same stream using [data chunks](https://ai-sdk.dev/docs/ai-sdk-ui/streaming-data#streaming-custom-data) with the [`UIMessageChunk`](https://ai-sdk.dev/docs/ai-sdk-ui/stream-protocol) type from the AI SDK:\n\nworkflows/ai-assistant.ts\n\n```\n\n```\n\napp/api/ai-assistant/route.ts\n\n```\n\n```\n\nFor a complete implementation, see the [flight booking example](https://github.com/vercel/workflow-examples/tree/main/flight-booking-app) which demonstrates streaming AI responses with tool progress updates.\n\n### [Streaming Between Steps](https://useworkflow.dev/docs/foundations/streaming\\#streaming-between-steps)\n\nOne step produces a stream and another step consumes it:\n\nworkflows/stream-pipeline.ts\n\n```\n\n```\n\n### [Processing Large Files Without Memory Overhead](https://useworkflow.dev/docs/foundations/streaming\\#processing-large-files-without-memory-overhead)\n\nProcess large files by streaming chunks through transformation steps:\n\nworkflows/file-processing.ts\n\n```\n\n```\n\n## [Best Practices](https://useworkflow.dev/docs/foundations/streaming\\#best-practices)\n\n**Release locks properly:**\n\n```\nconst writer = writable.getWriter();\ntry {\n  await writer.write(data);\n} finally {\n  writer.releaseLock(); // Always release\n}\n```\n\nStream locks acquired in a step only apply within that step, not across other steps. This enables multiple writers to write to the same stream concurrently.\n\nIf a lock is not released, the step function's HTTP request cannot terminate. Even though the step returns and the workflow continues, the underlying request will remain active until it times out—wasting compute resources unnecessarily.\n\n**Close streams when done:**\n\n```\nasync function finalizeStream() {\n  \"use step\";\n\n  await getWritable().close(); // Signal completion\n}\n```\n\nStreams are automatically closed when the workflow run completes, but explicitly closing them signals completion to consumers earlier.\n\n**Use typed streams for type safety:**\n\n```\nconst writable = getWritable<MyDataType>();\nconst writer = writable.getWriter();\nawait writer.write({ /* typed data */ });\n```\n\n## [Stream Failures](https://useworkflow.dev/docs/foundations/streaming\\#stream-failures)\n\nWhen a step returns a stream, the step is considered successful once it returns, even if the stream later encounters an error. The workflow won't automatically retry the step. The consumer of the stream must handle errors gracefully. For more on retry behavior, see [Errors and Retries](https://useworkflow.dev/docs/foundations/errors-and-retries).\n\nworkflows/stream-error-handling.ts\n\n```\n\n```\n\nStream errors don't trigger automatic retries for the producer step. Design your stream consumers to handle errors appropriately. Since the stream is already in an errored state, retrying the consumer won't help - use `FatalError` to fail the workflow immediately.\n\n## [Related Documentation](https://useworkflow.dev/docs/foundations/streaming\\#related-documentation)\n\n- [`getWritable()` API Reference](https://useworkflow.dev/docs/api-reference/workflow/get-writable) \\- Get the workflow's writable stream\n- [`sleep()` API Reference](https://useworkflow.dev/docs/api-reference/workflow/sleep) \\- Pause workflow execution for a duration\n- [`start()` API Reference](https://useworkflow.dev/docs/api-reference/workflow-api/start) \\- Start workflows and access the `Run` object\n- [`getRun()` API Reference](https://useworkflow.dev/docs/api-reference/workflow-api/get-run) \\- Retrieve runs and their streams later\n- [DurableAgent](https://useworkflow.dev/docs/api-reference/workflow-ai/durable-agent) \\- AI agents with built-in streaming support\n- [Errors and Retries](https://useworkflow.dev/docs/foundations/errors-and-retries) \\- Understanding error handling and retry behavior\n- [Serialization](https://useworkflow.dev/docs/foundations/serialization) \\- Understanding what data types can be passed in workflows\n- [Workflows and Steps](https://useworkflow.dev/docs/foundations/workflows-and-steps) \\- Core concepts of workflow execution\n\n[Hooks & Webhooks\\\\\n\\\\\nPrevious Page](https://useworkflow.dev/docs/foundations/hooks) [Serialization\\\\\n\\\\\nNext Page](https://useworkflow.dev/docs/foundations/serialization)\n\nOn this page\n\n[Getting Started with `getWritable()`](https://useworkflow.dev/docs/foundations/streaming#getting-started-with-getwritable) [Consuming the Stream](https://useworkflow.dev/docs/foundations/streaming#consuming-the-stream) [Resuming Streams from a Specific Point](https://useworkflow.dev/docs/foundations/streaming#resuming-streams-from-a-specific-point) [Streams as Data Types](https://useworkflow.dev/docs/foundations/streaming#streams-as-data-types) [Passing Streams as Arguments](https://useworkflow.dev/docs/foundations/streaming#passing-streams-as-arguments) [Important Limitation](https://useworkflow.dev/docs/foundations/streaming#important-limitation) [Namespaced Streams](https://useworkflow.dev/docs/foundations/streaming#namespaced-streams) [Consuming Namespaced Streams](https://useworkflow.dev/docs/foundations/streaming#consuming-namespaced-streams) [Common Patterns](https://useworkflow.dev/docs/foundations/streaming#common-patterns) [Progress Updates for Long-Running Tasks](https://useworkflow.dev/docs/foundations/streaming#progress-updates-for-long-running-tasks) [Streaming AI Responses with `DurableAgent`](https://useworkflow.dev/docs/foundations/streaming#streaming-ai-responses-with-durableagent) [Streaming Between Steps](https://useworkflow.dev/docs/foundations/streaming#streaming-between-steps) [Processing Large Files Without Memory Overhead](https://useworkflow.dev/docs/foundations/streaming#processing-large-files-without-memory-overhead) [Best Practices](https://useworkflow.dev/docs/foundations/streaming#best-practices) [Stream Failures](https://useworkflow.dev/docs/foundations/streaming#stream-failures) [Related Documentation](https://useworkflow.dev/docs/foundations/streaming#related-documentation)\n\n[GitHubEdit this page on GitHub](https://github.com/vercel/workflow/edit/main/content/docs/foundations/streaming.mdx) Scroll to topGive feedbackCopy pageAsk AI about this pageOpen in chat\n\n## Chat\n\nWhat is Workflow?How does retrying work?What control flow patterns are there?How do directives work?How do I build an AI agent?\n\nTip: You can open and close chat with `⌘I`\n\n0 / 1000",
  "metadata": {
    "language": "en",
    "viewport": "width=device-width, initial-scale=1",
    "og:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "og:image:width": "1200",
    "ogTitle": "Streaming",
    "title": "Streaming",
    "og:title": "Streaming",
    "og:image:type": "image/png",
    "twitter:card": "summary_large_image",
    "twitter:title": "Streaming",
    "twitter:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "twitter:image:height": "628",
    "twitter:image:type": "image/png",
    "twitter:image:width": "1200",
    "next-size-adjust": "",
    "og:image:height": "628",
    "ogImage": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "favicon": "https://useworkflow.dev/favicon.ico?favicon.e7ce0d1c.ico",
    "scrapeId": "019bf2d4-569c-75d7-940f-5a115f81d0b9",
    "sourceURL": "https://useworkflow.dev/docs/foundations/streaming",
    "url": "https://useworkflow.dev/docs/foundations/streaming",
    "statusCode": 200,
    "contentType": "text/html; charset=utf-8",
    "proxyUsed": "basic",
    "cacheState": "hit",
    "cachedAt": "2026-01-24T22:00:46.718Z",
    "creditsUsed": 1
  }
}