{
  "markdown": "[Vercel](https://vercel.com/) Slash [Workflow DevKit LogoWorkflow](https://useworkflow.dev/)\n\n- [Docs](https://useworkflow.dev/docs)\n- [Examples](https://github.com/vercel/workflow-examples)\n\n[X](https://x.com/workflowdevkit) [GitHub](https://github.com/vercel/workflow) Search... `⌘K`Ask AI\n\nAsk AI\n\nSearch... `⌘K`\n\n[Getting Started](https://useworkflow.dev/docs/getting-started)\n\n- [Next.js](https://useworkflow.dev/docs/getting-started/next)\n- [Vite](https://useworkflow.dev/docs/getting-started/vite)\n- [Astro](https://useworkflow.dev/docs/getting-started/astro)\n- [Express](https://useworkflow.dev/docs/getting-started/express)\n- [Fastify](https://useworkflow.dev/docs/getting-started/fastify)\n- [Hono](https://useworkflow.dev/docs/getting-started/hono)\n- [Nitro](https://useworkflow.dev/docs/getting-started/nitro)\n- [Nuxt](https://useworkflow.dev/docs/getting-started/nuxt)\n- [SvelteKit](https://useworkflow.dev/docs/getting-started/sveltekit)\n\n[Foundations](https://useworkflow.dev/docs/foundations)\n\n- [Workflows and Steps](https://useworkflow.dev/docs/foundations/workflows-and-steps)\n- [Starting Workflows](https://useworkflow.dev/docs/foundations/starting-workflows)\n- [Control Flow Patterns](https://useworkflow.dev/docs/foundations/control-flow-patterns)\n- [Errors & Retrying](https://useworkflow.dev/docs/foundations/errors-and-retries)\n- [Hooks & Webhooks](https://useworkflow.dev/docs/foundations/hooks)\n- [Streaming](https://useworkflow.dev/docs/foundations/streaming)\n- [Serialization](https://useworkflow.dev/docs/foundations/serialization)\n- [Idempotency](https://useworkflow.dev/docs/foundations/idempotency)\n\nHow it works\n\n[Observability](https://useworkflow.dev/docs/observability)\n\nAI Agents\n\n- [Building Durable AI Agents](https://useworkflow.dev/docs/ai)\n- [Streaming Updates from Tools](https://useworkflow.dev/docs/ai/streaming-updates-from-tools)\n- [Resumable Streams](https://useworkflow.dev/docs/ai/resumable-streams)\n- [Sleep, Suspense, and Scheduling](https://useworkflow.dev/docs/ai/sleep-and-delays)\n- [Human-in-the-Loop](https://useworkflow.dev/docs/ai/human-in-the-loop)\n- [Patterns for Defining Tools](https://useworkflow.dev/docs/ai/defining-tools)\n- [Chat Session Modeling](https://useworkflow.dev/docs/ai/chat-session-modeling)\n\n[Deploying](https://useworkflow.dev/docs/deploying)\n\n[Errors](https://useworkflow.dev/docs/errors)\n\n[API Reference](https://useworkflow.dev/docs/api-reference)\n\nSleep, Suspense, and SchedulingAdding a Sleep Tool\n\nAI Agents\n\n# Sleep, Suspense, and Scheduling\n\nAI agents sometimes need to pause execution in order to schedule recurring or future actions, wait before retrying an operation (e.g. for rate limiting), or wait for external state to be available.\n\nWorkflow DevKit's `sleep` function enables Agents to pause execution without consuming resources, and resume at a specified time, after a specified duration, or in response to an external event. Workflow operation that suspend will survive restarts, new deploys, and infrastructure changes, independent of whether the suspense takes seconds or months.\n\nSee the [`sleep()` API Reference](https://useworkflow.dev/docs/api-reference/workflow/sleep) for the full list of supported duration formats and detailed API documentation, and see the [hooks](https://useworkflow.dev/docs/foundations/hooks) documentation for more information on how to resume in response to external events.\n\n## [Adding a Sleep Tool](https://useworkflow.dev/docs/ai/sleep-and-delays\\#adding-a-sleep-tool)\n\nSleep is a built-in function in Workflow DevKit, so exposing it as a tool is as simple as wrapping it in a tool definition. Learn more about how to define tools in [Patterns for Defining Tools](https://useworkflow.dev/docs/ai/defining-tools).\n\n### [Define the Tool](https://useworkflow.dev/docs/ai/sleep-and-delays\\#define-the-tool)\n\nAdd a new \"sleep\" tool to the `tools` defined in `workflows/chat/steps/tools.ts`:\n\nworkflows/chat/steps/tools.ts\n\n```\n\n```\n\nNote that the `sleep()` function must be called from within a workflow context, not from within a step. This is why `executeSleep` does not have `\"use step\"` \\- it runs in the workflow context where `sleep()` is available.\n\nThis already makes the full sleep functionality available to the Agent!\n\n### [Show the tool status in the UI](https://useworkflow.dev/docs/ai/sleep-and-delays\\#show-the-tool-status-in-the-ui)\n\nTo round it off, extend the UI to display the tool call status. This can be done either by displaying the tool call information directly, or by emitting custom data parts to the stream (see [Streaming Updates from Tools](https://useworkflow.dev/docs/ai/streaming-updates-from-tools) for more details). In this case, since there aren't any fine-grained progress updates to show, we'll just display the tool call information directly:\n\napp/page.tsx\n\n```\n\n```\n\nNow, try out the Flight Booking Agent again, and ask it to sleep for 10 seconds before checking any flight. You'll see the agent pause, and the UI reflect the tool call status.\n\n## [Use Cases](https://useworkflow.dev/docs/ai/sleep-and-delays\\#use-cases)\n\nAside from providing `sleep()` as a tool, there are other use cases for Agents that commonly call for suspension and resumption.\n\n### [Rate Limiting](https://useworkflow.dev/docs/ai/sleep-and-delays\\#rate-limiting)\n\nWhen hitting API rate limits, use `RetryableError` with a delay:\n\n```\nasync function callRateLimitedAPI(endpoint: string) {\n  \"use step\";\n\n  const response = await fetch(endpoint);\n\n  if (response.status === 429) {\n    const retryAfter = response.headers.get(\"Retry-After\");\n    throw new RetryableError(\"Rate limited\", {\n      retryAfter: retryAfter ? parseInt(retryAfter) * 1000 : \"1m\",\n    });\n  }\n\n  return response.json();\n}\n```\n\n## [Related Documentation](https://useworkflow.dev/docs/ai/sleep-and-delays\\#related-documentation)\n\n- [`sleep()` API Reference](https://useworkflow.dev/docs/api-reference/workflow/sleep) \\- Full API documentation with all duration formats\n- [Workflows and Steps](https://useworkflow.dev/docs/foundations/workflows-and-steps) \\- Understanding workflow context\n- [Errors and Retries](https://useworkflow.dev/docs/foundations/errors-and-retries) \\- Using `RetryableError` with delays\n\n[Resumable Streams\\\\\n\\\\\nPrevious Page](https://useworkflow.dev/docs/ai/resumable-streams) [Human-in-the-Loop\\\\\n\\\\\nNext Page](https://useworkflow.dev/docs/ai/human-in-the-loop)\n\nOn this page\n\n[Adding a Sleep Tool](https://useworkflow.dev/docs/ai/sleep-and-delays#adding-a-sleep-tool) [Define the Tool](https://useworkflow.dev/docs/ai/sleep-and-delays#define-the-tool) [Show the tool status in the UI](https://useworkflow.dev/docs/ai/sleep-and-delays#show-the-tool-status-in-the-ui) [Use Cases](https://useworkflow.dev/docs/ai/sleep-and-delays#use-cases) [Rate Limiting](https://useworkflow.dev/docs/ai/sleep-and-delays#rate-limiting) [Related Documentation](https://useworkflow.dev/docs/ai/sleep-and-delays#related-documentation)\n\n[GitHubEdit this page on GitHub](https://github.com/vercel/workflow/edit/main/content/docs/ai/sleep-and-delays.mdx) Scroll to topGive feedbackCopy pageAsk AI about this pageOpen in chat\n\n## Chat\n\nWhat is Workflow?How does retrying work?What control flow patterns are there?How do directives work?How do I build an AI agent?\n\nTip: You can open and close chat with `⌘I`\n\n0 / 1000",
  "metadata": {
    "twitter:image:height": "628",
    "og:image:width": "1200",
    "og:image:type": "image/png",
    "twitter:title": "Sleep, Suspense, and Scheduling",
    "og:title": "Sleep, Suspense, and Scheduling",
    "og:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "next-size-adjust": "",
    "twitter:card": "summary_large_image",
    "viewport": "width=device-width, initial-scale=1",
    "twitter:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "twitter:image:type": "image/png",
    "twitter:image:width": "1200",
    "title": "Sleep, Suspense, and Scheduling",
    "og:image:height": "628",
    "ogImage": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "ogTitle": "Sleep, Suspense, and Scheduling",
    "language": "en",
    "favicon": "https://useworkflow.dev/favicon.ico?favicon.e7ce0d1c.ico",
    "scrapeId": "019bf2d4-569c-75d7-940f-11f2b60f839b",
    "sourceURL": "https://useworkflow.dev/docs/ai/sleep-and-delays",
    "url": "https://useworkflow.dev/docs/ai/sleep-and-delays",
    "statusCode": 200,
    "contentType": "text/html; charset=utf-8",
    "proxyUsed": "basic",
    "cacheState": "hit",
    "cachedAt": "2026-01-24T22:00:37.838Z",
    "creditsUsed": 1
  }
}