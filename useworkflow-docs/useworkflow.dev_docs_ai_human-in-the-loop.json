{
  "markdown": "[Vercel](https://vercel.com/) Slash [Workflow DevKit LogoWorkflow](https://useworkflow.dev/)\n\n- [Docs](https://useworkflow.dev/docs)\n- [Examples](https://github.com/vercel/workflow-examples)\n\n[X](https://x.com/workflowdevkit) [GitHub](https://github.com/vercel/workflow) Search... `⌘K`Ask AI\n\nAsk AI\n\nSearch... `⌘K`\n\n[Getting Started](https://useworkflow.dev/docs/getting-started)\n\n- [Next.js](https://useworkflow.dev/docs/getting-started/next)\n- [Vite](https://useworkflow.dev/docs/getting-started/vite)\n- [Astro](https://useworkflow.dev/docs/getting-started/astro)\n- [Express](https://useworkflow.dev/docs/getting-started/express)\n- [Fastify](https://useworkflow.dev/docs/getting-started/fastify)\n- [Hono](https://useworkflow.dev/docs/getting-started/hono)\n- [Nitro](https://useworkflow.dev/docs/getting-started/nitro)\n- [Nuxt](https://useworkflow.dev/docs/getting-started/nuxt)\n- [SvelteKit](https://useworkflow.dev/docs/getting-started/sveltekit)\n\n[Foundations](https://useworkflow.dev/docs/foundations)\n\n- [Workflows and Steps](https://useworkflow.dev/docs/foundations/workflows-and-steps)\n- [Starting Workflows](https://useworkflow.dev/docs/foundations/starting-workflows)\n- [Control Flow Patterns](https://useworkflow.dev/docs/foundations/control-flow-patterns)\n- [Errors & Retrying](https://useworkflow.dev/docs/foundations/errors-and-retries)\n- [Hooks & Webhooks](https://useworkflow.dev/docs/foundations/hooks)\n- [Streaming](https://useworkflow.dev/docs/foundations/streaming)\n- [Serialization](https://useworkflow.dev/docs/foundations/serialization)\n- [Idempotency](https://useworkflow.dev/docs/foundations/idempotency)\n\nHow it works\n\n[Observability](https://useworkflow.dev/docs/observability)\n\nAI Agents\n\n- [Building Durable AI Agents](https://useworkflow.dev/docs/ai)\n- [Streaming Updates from Tools](https://useworkflow.dev/docs/ai/streaming-updates-from-tools)\n- [Resumable Streams](https://useworkflow.dev/docs/ai/resumable-streams)\n- [Sleep, Suspense, and Scheduling](https://useworkflow.dev/docs/ai/sleep-and-delays)\n- [Human-in-the-Loop](https://useworkflow.dev/docs/ai/human-in-the-loop)\n- [Patterns for Defining Tools](https://useworkflow.dev/docs/ai/defining-tools)\n- [Chat Session Modeling](https://useworkflow.dev/docs/ai/chat-session-modeling)\n\n[Deploying](https://useworkflow.dev/docs/deploying)\n\n[Errors](https://useworkflow.dev/docs/errors)\n\n[API Reference](https://useworkflow.dev/docs/api-reference)\n\nHuman-in-the-LoopHow It Works\n\nAI Agents\n\n# Human-in-the-Loop\n\nA common pre-requisite for running AI agents in production is the ability to wait for human input or external events before proceeding.\n\nWorkflow DevKit's [webhook](https://useworkflow.dev/docs/api-reference/workflow/create-webhook) and [hook](https://useworkflow.dev/docs/api-reference/workflow/define-hook) primitives enable \"human-in-the-loop\" patterns where workflows pause until a human takes action, allowing smooth resumption of workflows even after days of inactivity, and provides stability across code deployments.\n\nIf you need to react to external events programmatically, see the [hooks](https://useworkflow.dev/docs/foundations/hooks) documentation for more information. This part of the guide will focus on the human-in-the-loop pattern, which is a subset of the more general hook pattern.\n\n## [How It Works](https://useworkflow.dev/docs/ai/human-in-the-loop\\#how-it-works)\n\n`defineHook()` creates a typed hook that can be awaited in a workflow. When the tool is called, it creates a hook instance using the tool call ID as the token.\n\nThe workflow pauses at `await hook` \\- no compute resources are consumed while waiting for the human to take action.\n\nThe UI displays the pending tool call with its input data (flight details, price, etc.) and renders approval controls.\n\nThe user submits their decision through an API endpoint, which resumes the hook with the approval data.\n\nThe workflow receives the approval data and resumes execution.\n\nWhile this demo will use a client side button for human approval, you could just as easily create a webhook and send the approval link over email or slack to resume the agent.\n\n## [Creating a Booking Approval Tool](https://useworkflow.dev/docs/ai/human-in-the-loop\\#creating-a-booking-approval-tool)\n\nAdd a tool that allows the agent to deliberately pause execution until a human approves or rejects a flight booking:\n\n### [Define the Hook](https://useworkflow.dev/docs/ai/human-in-the-loop\\#define-the-hook)\n\nCreate a typed hook with a Zod schema for validation:\n\nworkflow/hooks/booking-approval.ts\n\n```\n\n```\n\n### [Implement the Tool](https://useworkflow.dev/docs/ai/human-in-the-loop\\#implement-the-tool)\n\nCreate a tool that creates a hook instance using the tool call ID as the token. The UI will use this ID to submit the approval.\n\nworkflows/chat/steps/tools.ts\n\n```\n\n```\n\nNote that the `defineHook().create()` function must be called from within a workflow context, not from within a step. This is why `executeBookingApproval` does not have `\"use step\"` \\- it runs in the workflow context where hooks are available.\n\n### [Create the API Route](https://useworkflow.dev/docs/ai/human-in-the-loop\\#create-the-api-route)\n\nCreate a new API endpoint that the UI will call to submit the approval decision:\n\napp/api/hooks/approval/route.ts\n\n```\n\n```\n\n### [Create the Approval Component](https://useworkflow.dev/docs/ai/human-in-the-loop\\#create-the-approval-component)\n\nBuild a new component that reacts to the tool call data, and allows the user to approve or reject the booking:\n\ncomponents/booking-approval.tsx\n\n```\n\n```\n\n### [Show the Tool Status in the UI](https://useworkflow.dev/docs/ai/human-in-the-loop\\#show-the-tool-status-in-the-ui)\n\nUse the component we just created to render the tool call and approval controls in your chat interface:\n\napp/page.tsx\n\n```\n\n```\n\n## [Using Webhooks Directly](https://useworkflow.dev/docs/ai/human-in-the-loop\\#using-webhooks-directly)\n\nFor simpler cases where you don't need type-safe validation or programmatic resumption, you can use [`createWebhook()`](https://useworkflow.dev/docs/api-reference/workflow/create-webhook) directly. This generates a unique URL that can be called to resume the workflow:\n\nworkflows/chat/steps/tools.ts\n\n```\n\n```\n\nThe webhook URL can be called directly with a POST request containing the approval data. This is useful for:\n\n- External systems that need to call back into your workflow\n- Payment provider callbacks\n- Email-based approval links\n\n## [Related Documentation](https://useworkflow.dev/docs/ai/human-in-the-loop\\#related-documentation)\n\n- [Hooks & Webhooks](https://useworkflow.dev/docs/foundations/hooks) \\- Complete guide to hooks and webhooks\n- [`createWebhook()` API Reference](https://useworkflow.dev/docs/api-reference/workflow/create-webhook) \\- Webhook configuration options\n- [`defineHook()` API Reference](https://useworkflow.dev/docs/api-reference/workflow/define-hook) \\- Type-safe hook definitions\n\n[Sleep, Suspense, and Scheduling\\\\\n\\\\\nPrevious Page](https://useworkflow.dev/docs/ai/sleep-and-delays) [Patterns for Defining Tools\\\\\n\\\\\nNext Page](https://useworkflow.dev/docs/ai/defining-tools)\n\nOn this page\n\n[How It Works](https://useworkflow.dev/docs/ai/human-in-the-loop#how-it-works) [Creating a Booking Approval Tool](https://useworkflow.dev/docs/ai/human-in-the-loop#creating-a-booking-approval-tool) [Define the Hook](https://useworkflow.dev/docs/ai/human-in-the-loop#define-the-hook) [Implement the Tool](https://useworkflow.dev/docs/ai/human-in-the-loop#implement-the-tool) [Create the API Route](https://useworkflow.dev/docs/ai/human-in-the-loop#create-the-api-route) [Create the Approval Component](https://useworkflow.dev/docs/ai/human-in-the-loop#create-the-approval-component) [Show the Tool Status in the UI](https://useworkflow.dev/docs/ai/human-in-the-loop#show-the-tool-status-in-the-ui) [Using Webhooks Directly](https://useworkflow.dev/docs/ai/human-in-the-loop#using-webhooks-directly) [Related Documentation](https://useworkflow.dev/docs/ai/human-in-the-loop#related-documentation)\n\n[GitHubEdit this page on GitHub](https://github.com/vercel/workflow/edit/main/content/docs/ai/human-in-the-loop.mdx) Scroll to topGive feedbackCopy pageAsk AI about this pageOpen in chat\n\n## Chat\n\nWhat is Workflow?How does retrying work?What control flow patterns are there?How do directives work?How do I build an AI agent?\n\nTip: You can open and close chat with `⌘I`\n\n0 / 1000",
  "metadata": {
    "ogTitle": "Human-in-the-Loop",
    "title": "Human-in-the-Loop",
    "ogImage": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "twitter:image:type": "image/png",
    "og:title": "Human-in-the-Loop",
    "twitter:image:height": "628",
    "twitter:card": "summary_large_image",
    "next-size-adjust": "",
    "twitter:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "viewport": "width=device-width, initial-scale=1",
    "twitter:image:width": "1200",
    "language": "en",
    "og:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "og:image:type": "image/png",
    "twitter:title": "Human-in-the-Loop",
    "og:image:width": "1200",
    "og:image:height": "628",
    "favicon": "https://useworkflow.dev/favicon.ico?favicon.e7ce0d1c.ico",
    "scrapeId": "019bf2d4-569c-75d7-940e-ef637b23d1a7",
    "sourceURL": "https://useworkflow.dev/docs/ai/human-in-the-loop",
    "url": "https://useworkflow.dev/docs/ai/human-in-the-loop",
    "statusCode": 200,
    "contentType": "text/html; charset=utf-8",
    "proxyUsed": "basic",
    "cacheState": "hit",
    "cachedAt": "2026-01-24T22:00:45.666Z",
    "creditsUsed": 1
  }
}