{
  "markdown": "[Vercel](https://vercel.com/) Slash [Workflow DevKit LogoWorkflow](https://useworkflow.dev/)\n\n- [Docs](https://useworkflow.dev/docs)\n- [Examples](https://github.com/vercel/workflow-examples)\n\n[X](https://x.com/workflowdevkit) [GitHub](https://github.com/vercel/workflow) Search... `⌘K`Ask AI\n\nAsk AI\n\nSearch... `⌘K`\n\n[Getting Started](https://useworkflow.dev/docs/getting-started)\n\n- [Next.js](https://useworkflow.dev/docs/getting-started/next)\n- [Vite](https://useworkflow.dev/docs/getting-started/vite)\n- [Astro](https://useworkflow.dev/docs/getting-started/astro)\n- [Express](https://useworkflow.dev/docs/getting-started/express)\n- [Fastify](https://useworkflow.dev/docs/getting-started/fastify)\n- [Hono](https://useworkflow.dev/docs/getting-started/hono)\n- [Nitro](https://useworkflow.dev/docs/getting-started/nitro)\n- [Nuxt](https://useworkflow.dev/docs/getting-started/nuxt)\n- [SvelteKit](https://useworkflow.dev/docs/getting-started/sveltekit)\n\n[Foundations](https://useworkflow.dev/docs/foundations)\n\n- [Workflows and Steps](https://useworkflow.dev/docs/foundations/workflows-and-steps)\n- [Starting Workflows](https://useworkflow.dev/docs/foundations/starting-workflows)\n- [Control Flow Patterns](https://useworkflow.dev/docs/foundations/control-flow-patterns)\n- [Errors & Retrying](https://useworkflow.dev/docs/foundations/errors-and-retries)\n- [Hooks & Webhooks](https://useworkflow.dev/docs/foundations/hooks)\n- [Streaming](https://useworkflow.dev/docs/foundations/streaming)\n- [Serialization](https://useworkflow.dev/docs/foundations/serialization)\n- [Idempotency](https://useworkflow.dev/docs/foundations/idempotency)\n\nHow it works\n\n[Observability](https://useworkflow.dev/docs/observability)\n\nAI Agents\n\n- [Building Durable AI Agents](https://useworkflow.dev/docs/ai)\n- [Streaming Updates from Tools](https://useworkflow.dev/docs/ai/streaming-updates-from-tools)\n- [Resumable Streams](https://useworkflow.dev/docs/ai/resumable-streams)\n- [Sleep, Suspense, and Scheduling](https://useworkflow.dev/docs/ai/sleep-and-delays)\n- [Human-in-the-Loop](https://useworkflow.dev/docs/ai/human-in-the-loop)\n- [Patterns for Defining Tools](https://useworkflow.dev/docs/ai/defining-tools)\n- [Chat Session Modeling](https://useworkflow.dev/docs/ai/chat-session-modeling)\n\n[Deploying](https://useworkflow.dev/docs/deploying)\n\n[Errors](https://useworkflow.dev/docs/errors)\n\n[API Reference](https://useworkflow.dev/docs/api-reference)\n\ngetWritableAPI Signature\n\n[API Reference](https://useworkflow.dev/docs/api-reference) [workflow](https://useworkflow.dev/docs/api-reference/workflow)\n\n# getWritable\n\nRetrieves the current workflow run's default writable stream.\n\nThe writable stream can be obtained in workflow functions and passed to steps, or called directly within step functions to write data that can be read outside the workflow by using the `readable` property of the [`Run` object](https://useworkflow.dev/docs/api-reference/workflow-api/get-run).\n\nUse this function in your workflows and steps to produce streaming output that can be consumed by clients in real-time.\n\nThis function can only be called inside a workflow or step function (functions\nwith `\"use workflow\"` or `\"use step\"` directive)\n\n**Important:** While you can call `getWritable()` inside a workflow function\nto obtain the stream, you **cannot interact with the stream directly** in the\nworkflow context (e.g., calling `getWriter()`, `write()`, or `close()`). The\nstream must be passed to step functions as arguments, or steps can call\n`getWritable()` directly themselves.\n\n```\nimport { getWritable } from \"workflow\";\n\nexport async function myWorkflow() {\n  \"use workflow\";\n\n  // Get the writable stream\n  const writable = getWritable();\n\n  // Pass it to a step function to interact with it\n  await writeToStream(writable);\n}\n\nasync function writeToStream(writable: WritableStream) {\n  \"use step\";\n\n  const writer = writable.getWriter();\n  await writer.write(new TextEncoder().encode(\"Hello from workflow!\"));\n  writer.releaseLock();\n  await writable.close();\n}\n```\n\n## [API Signature](https://useworkflow.dev/docs/api-reference/workflow/get-writable\\#api-signature)\n\n### [Parameters](https://useworkflow.dev/docs/api-reference/workflow/get-writable\\#parameters)\n\n| Name | Type | Description |\n| --- | --- | --- |\n| `options` | WorkflowWritableStreamOptions | Optional configuration for the writable stream |\n\n### [Returns](https://useworkflow.dev/docs/api-reference/workflow/get-writable\\#returns)\n\n`WritableStream<W>`\n\nReturns a `WritableStream<W>` where `W` is the type of data you plan to write to the stream.\n\n## [Good to Know](https://useworkflow.dev/docs/api-reference/workflow/get-writable\\#good-to-know)\n\n- **Workflow functions can only obtain the stream** \\- Call `getWritable()` in a workflow to get the stream reference, but you cannot call methods like `getWriter()`, `write()`, or `close()` directly in the workflow context.\n- **Step functions can interact with streams** \\- Steps can receive the stream as an argument or call `getWritable()` directly, and they can freely interact with it (write, close, etc.).\n- When called from a workflow, the stream must be passed as an argument to steps for interaction.\n- When called from a step, it retrieves the same workflow-scoped stream directly.\n- Always release the writer lock after writing to prevent resource leaks.\n- The stream can write binary data (using `TextEncoder`) or structured objects.\n- Remember to close the stream when finished to signal completion.\n\n## [Examples](https://useworkflow.dev/docs/api-reference/workflow/get-writable\\#examples)\n\n### [Basic Text Streaming](https://useworkflow.dev/docs/api-reference/workflow/get-writable\\#basic-text-streaming)\n\nHere's a simple example streaming text data:\n\n```\nimport { sleep, getWritable } from \"workflow\";\n\nexport async function outputStreamWorkflow() {\n  \"use workflow\";\n\n  const writable = getWritable();\n\n  await sleep(\"1s\");\n  await stepWithOutputStream(writable);\n  await sleep(\"1s\");\n  await stepCloseOutputStream(writable);\n\n  return \"done\";\n}\n\nasync function stepWithOutputStream(writable: WritableStream) {\n  \"use step\";\n\n  const writer = writable.getWriter();\n  // Write binary data using TextEncoder\n  await writer.write(new TextEncoder().encode(\"Hello, world!\"));\n  writer.releaseLock();\n}\n\nasync function stepCloseOutputStream(writable: WritableStream) {\n  \"use step\";\n\n  // Close the stream to signal completion\n  await writable.close();\n}\n```\n\n### [Calling `getWritable()` Inside Steps](https://useworkflow.dev/docs/api-reference/workflow/get-writable\\#calling-getwritable-inside-steps)\n\nYou can also call `getWritable()` directly inside step functions without passing it as a parameter:\n\n```\nimport { sleep, getWritable } from \"workflow\";\n\nexport async function outputStreamFromStepWorkflow() {\n  \"use workflow\";\n\n  // No need to create or pass the stream - steps can get it themselves\n  await sleep(\"1s\");\n  await stepWithOutputStreamInside();\n  await sleep(\"1s\");\n  await stepCloseOutputStreamInside();\n\n  return \"done\";\n}\n\nasync function stepWithOutputStreamInside() {\n  \"use step\";\n\n  // Call getWritable() directly inside the step\n  const writable = getWritable();\n  const writer = writable.getWriter();\n\n  await writer.write(new TextEncoder().encode(\"Hello from step!\"));\n  writer.releaseLock();\n}\n\nasync function stepCloseOutputStreamInside() {\n  \"use step\";\n\n  // Call getWritable() to get the same stream\n  const writable = getWritable();\n  await writable.close();\n}\n```\n\n### [Using Namespaced Streams in Steps](https://useworkflow.dev/docs/api-reference/workflow/get-writable\\#using-namespaced-streams-in-steps)\n\nYou can also use namespaced streams when calling `getWritable()` from steps:\n\n```\nimport { getWritable } from \"workflow\";\n\nexport async function multiStreamWorkflow() {\n  \"use workflow\";\n\n  // Steps will access both streams by namespace\n  await writeToDefaultStream();\n  await writeToNamedStream();\n  await closeStreams();\n\n  return \"done\";\n}\n\nasync function writeToDefaultStream() {\n  \"use step\";\n\n  const writable = getWritable(); // Default stream\n  const writer = writable.getWriter();\n  await writer.write({ message: \"Default stream data\" });\n  writer.releaseLock();\n}\n\nasync function writeToNamedStream() {\n  \"use step\";\n\n  const writable = getWritable({ namespace: \"logs\" });\n  const writer = writable.getWriter();\n  await writer.write({ log: \"Named stream data\" });\n  writer.releaseLock();\n}\n\nasync function closeStreams() {\n  \"use step\";\n\n  await getWritable().close(); // Close default stream\n  await getWritable({ namespace: \"logs\" }).close(); // Close named stream\n}\n```\n\n### [Advanced Chat Streaming](https://useworkflow.dev/docs/api-reference/workflow/get-writable\\#advanced-chat-streaming)\n\nHere's a more complex example showing how you might stream AI chat responses:\n\n```\nimport { getWritable } from \"workflow\";\nimport { generateId, streamText, type UIMessageChunk } from \"ai\";\n\nexport async function chat(messages: UIMessage[]) {\n  \"use workflow\";\n\n  // Get typed writable stream for UI message chunks\n  const writable = getWritable<UIMessageChunk>();\n\n  // Start the stream\n  await startStream(writable);\n\n  let currentMessages = [...messages];\n\n  // Process messages in steps\n  for (let i = 0; i < MAX_STEPS; i++) {\n    const result = await streamTextStep(currentMessages, writable);\n    currentMessages.push(result.messages);\n\n    if (result.finishReason !== \"tool-calls\") {\n      break;\n    }\n  }\n\n  // End the stream\n  await endStream(writable);\n}\n\nasync function startStream(writable: WritableStream<UIMessageChunk>) {\n  \"use step\";\n\n  const writer = writable.getWriter();\n\n  // Send start message\n  writer.write({\n    type: \"start\",\n    messageMetadata: {\n      createdAt: Date.now(),\n      messageId: generateId(),\n    },\n  });\n\n  writer.releaseLock();\n}\n\nasync function streamTextStep(\n  messages: UIMessage[],\n  writable: WritableStream<UIMessageChunk>\n) {\n  \"use step\";\n\n  const writer = writable.getWriter();\n\n  // Call streamText from the AI SDK\n  const result = streamText({\n    model: \"gpt-4\",\n    messages,\n    /* other options */\n  });\n\n  // Pipe the AI stream into the writable stream\n  const reader = result\n    .toUIMessageStream({ sendStart: false, sendFinish: false })\n    .getReader();\n\n  while (true) {\n    const { done, value } = await reader.read();\n    if (done) break;\n    await writer.write(value);\n  }\n\n  reader.releaseLock();\n  writer.releaseLock();\n\n  // Return the result for the workflow to use\n  return {\n    messages: await result.response.then((r) => r.messages),\n    finishReason: await result.finishReason,\n  };\n}\n\nasync function endStream(writable: WritableStream<UIMessageChunk>) {\n  \"use step\";\n\n  // Close the stream to signal completion\n  await writable.close();\n}\n```\n\n[getWorkflowMetadata\\\\\n\\\\\nPrevious Page](https://useworkflow.dev/docs/api-reference/workflow/get-workflow-metadata) [sleep\\\\\n\\\\\nNext Page](https://useworkflow.dev/docs/api-reference/workflow/sleep)\n\nOn this page\n\n[API Signature](https://useworkflow.dev/docs/api-reference/workflow/get-writable#api-signature) [Parameters](https://useworkflow.dev/docs/api-reference/workflow/get-writable#parameters) [Returns](https://useworkflow.dev/docs/api-reference/workflow/get-writable#returns) [Good to Know](https://useworkflow.dev/docs/api-reference/workflow/get-writable#good-to-know) [Examples](https://useworkflow.dev/docs/api-reference/workflow/get-writable#examples) [Basic Text Streaming](https://useworkflow.dev/docs/api-reference/workflow/get-writable#basic-text-streaming) [Calling `getWritable()` Inside Steps](https://useworkflow.dev/docs/api-reference/workflow/get-writable#calling-getwritable-inside-steps) [Using Namespaced Streams in Steps](https://useworkflow.dev/docs/api-reference/workflow/get-writable#using-namespaced-streams-in-steps) [Advanced Chat Streaming](https://useworkflow.dev/docs/api-reference/workflow/get-writable#advanced-chat-streaming)\n\n[GitHubEdit this page on GitHub](https://github.com/vercel/workflow/edit/main/content/docs/api-reference/workflow/get-writable.mdx) Scroll to topGive feedbackCopy pageAsk AI about this pageOpen in chat\n\n## Chat\n\nWhat is Workflow?How does retrying work?What control flow patterns are there?How do directives work?How do I build an AI agent?\n\nTip: You can open and close chat with `⌘I`\n\n0 / 1000",
  "metadata": {
    "description": "Retrieves the current workflow run's default writable stream.",
    "twitter:card": "summary_large_image",
    "twitter:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "twitter:image:width": "1200",
    "twitter:image:height": "628",
    "ogImage": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "next-size-adjust": "",
    "viewport": "width=device-width, initial-scale=1",
    "og:description": "Retrieves the current workflow run's default writable stream.",
    "og:title": "getWritable",
    "og:image:height": "628",
    "language": "en",
    "twitter:title": "getWritable",
    "title": "getWritable",
    "twitter:description": "Retrieves the current workflow run's default writable stream.",
    "ogDescription": "Retrieves the current workflow run's default writable stream.",
    "twitter:image:type": "image/png",
    "ogTitle": "getWritable",
    "og:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "og:image:type": "image/png",
    "og:image:width": "1200",
    "favicon": "https://useworkflow.dev/favicon.ico?favicon.e7ce0d1c.ico",
    "scrapeId": "019bf2d4-569c-75d7-940f-404674d884b2",
    "sourceURL": "https://useworkflow.dev/docs/api-reference/workflow/get-writable",
    "url": "https://useworkflow.dev/docs/api-reference/workflow/get-writable",
    "statusCode": 200,
    "contentType": "text/html; charset=utf-8",
    "proxyUsed": "basic",
    "cacheState": "hit",
    "cachedAt": "2026-01-24T22:00:46.360Z",
    "creditsUsed": 1
  }
}