{
  "markdown": "[Vercel](https://vercel.com/) Slash [Workflow DevKit LogoWorkflow](https://useworkflow.dev/)\n\n- [Docs](https://useworkflow.dev/docs)\n- [Examples](https://github.com/vercel/workflow-examples)\n\n[X](https://x.com/workflowdevkit) [GitHub](https://github.com/vercel/workflow) Search... `⌘K`Ask AI\n\nAsk AI\n\nSearch... `⌘K`\n\n[Getting Started](https://useworkflow.dev/docs/getting-started)\n\n- [Next.js](https://useworkflow.dev/docs/getting-started/next)\n- [Vite](https://useworkflow.dev/docs/getting-started/vite)\n- [Astro](https://useworkflow.dev/docs/getting-started/astro)\n- [Express](https://useworkflow.dev/docs/getting-started/express)\n- [Fastify](https://useworkflow.dev/docs/getting-started/fastify)\n- [Hono](https://useworkflow.dev/docs/getting-started/hono)\n- [Nitro](https://useworkflow.dev/docs/getting-started/nitro)\n- [Nuxt](https://useworkflow.dev/docs/getting-started/nuxt)\n- [SvelteKit](https://useworkflow.dev/docs/getting-started/sveltekit)\n\n[Foundations](https://useworkflow.dev/docs/foundations)\n\n- [Workflows and Steps](https://useworkflow.dev/docs/foundations/workflows-and-steps)\n- [Starting Workflows](https://useworkflow.dev/docs/foundations/starting-workflows)\n- [Control Flow Patterns](https://useworkflow.dev/docs/foundations/control-flow-patterns)\n- [Errors & Retrying](https://useworkflow.dev/docs/foundations/errors-and-retries)\n- [Hooks & Webhooks](https://useworkflow.dev/docs/foundations/hooks)\n- [Streaming](https://useworkflow.dev/docs/foundations/streaming)\n- [Serialization](https://useworkflow.dev/docs/foundations/serialization)\n- [Idempotency](https://useworkflow.dev/docs/foundations/idempotency)\n\nHow it works\n\n[Observability](https://useworkflow.dev/docs/observability)\n\nAI Agents\n\n- [Building Durable AI Agents](https://useworkflow.dev/docs/ai)\n- [Streaming Updates from Tools](https://useworkflow.dev/docs/ai/streaming-updates-from-tools)\n- [Resumable Streams](https://useworkflow.dev/docs/ai/resumable-streams)\n- [Sleep, Suspense, and Scheduling](https://useworkflow.dev/docs/ai/sleep-and-delays)\n- [Human-in-the-Loop](https://useworkflow.dev/docs/ai/human-in-the-loop)\n- [Patterns for Defining Tools](https://useworkflow.dev/docs/ai/defining-tools)\n- [Chat Session Modeling](https://useworkflow.dev/docs/ai/chat-session-modeling)\n\n[Deploying](https://useworkflow.dev/docs/deploying)\n\n[Errors](https://useworkflow.dev/docs/errors)\n\n[API Reference](https://useworkflow.dev/docs/api-reference)\n\nfetch-in-workflowError Message\n\n[Errors](https://useworkflow.dev/docs/errors)\n\n# fetch-in-workflow\n\nThis error occurs when you try to use `fetch()` directly in a workflow function, or when a library (like the AI SDK) tries to call `fetch()` under the hood.\n\n## [Error Message](https://useworkflow.dev/docs/errors/fetch-in-workflow\\#error-message)\n\n```\nGlobal \"fetch\" is unavailable in workflow functions. Use the \"fetch\" step function from \"workflow\" to make HTTP requests.\n```\n\n## [Why This Happens](https://useworkflow.dev/docs/errors/fetch-in-workflow\\#why-this-happens)\n\nWorkflow functions run in a sandboxed environment without direct access to `fetch()`.\n\nMany libraries make HTTP requests under the hood. For example, the AI SDK's `generateText()` function calls `fetch()` to make HTTP requests to AI providers. When these libraries run inside a workflow function, they fail because the global `fetch` is not available.\n\n## [Quick Fix](https://useworkflow.dev/docs/errors/fetch-in-workflow\\#quick-fix)\n\nImport the `fetch` step function from the `workflow` package and assign it to `globalThis.fetch` inside your workflow function. This version of `fetch` is a step function that wraps the standard `fetch` API, automatically handling serialization and providing retry capabilities. This will also make `fetch()` available to all functions and libraries in the current workflow function.\n\n**Before:**\n\nworkflows/ai.ts\n\n```\n\n```\n\n**After:**\n\nworkflows/ai.ts\n\n```\n\n```\n\n## [Common Scenarios](https://useworkflow.dev/docs/errors/fetch-in-workflow\\#common-scenarios)\n\n### [AI SDK Integration](https://useworkflow.dev/docs/errors/fetch-in-workflow\\#ai-sdk-integration)\n\nThis is the most common scenario - using AI SDK functions that make HTTP requests:\n\n```\nimport { generateText, streamText } from \"ai\";\nimport { openai } from \"@ai-sdk/openai\";\nimport { fetch } from \"workflow\";\n\nexport async function aiWorkflow(userMessage: string) {\n  \"use workflow\";\n\n  globalThis.fetch = fetch;\n\n  // generateText makes HTTP requests to OpenAI\n  const response = await generateText({\n    model: openai(\"gpt-4\"),\n    prompt: userMessage,\n  });\n\n  return response.text;\n}\n```\n\n### [Direct API Calls](https://useworkflow.dev/docs/errors/fetch-in-workflow\\#direct-api-calls)\n\nYou can also use the fetch step function directly for your own HTTP requests:\n\n```\nimport { fetch } from \"workflow\";\n\nexport async function dataWorkflow() {\n  \"use workflow\";\n\n  // Use fetch directly for HTTP requests\n  const response = await fetch(\"https://api.example.com/data\");\n  const data = await response.json();\n\n  return data;\n}\n```\n\nFor more details on the `fetch` step function, see the [fetch API reference](https://useworkflow.dev/docs/api-reference/workflow/fetch).\n\n[Errors\\\\\n\\\\\nPrevious Page](https://useworkflow.dev/docs/errors) [hook-conflict\\\\\n\\\\\nNext Page](https://useworkflow.dev/docs/errors/hook-conflict)\n\nOn this page\n\n[Error Message](https://useworkflow.dev/docs/errors/fetch-in-workflow#error-message) [Why This Happens](https://useworkflow.dev/docs/errors/fetch-in-workflow#why-this-happens) [Quick Fix](https://useworkflow.dev/docs/errors/fetch-in-workflow#quick-fix) [Common Scenarios](https://useworkflow.dev/docs/errors/fetch-in-workflow#common-scenarios) [AI SDK Integration](https://useworkflow.dev/docs/errors/fetch-in-workflow#ai-sdk-integration) [Direct API Calls](https://useworkflow.dev/docs/errors/fetch-in-workflow#direct-api-calls)\n\n[GitHubEdit this page on GitHub](https://github.com/vercel/workflow/edit/main/content/docs/errors/fetch-in-workflow.mdx) Scroll to topGive feedbackCopy pageAsk AI about this pageOpen in chat\n\n## Chat\n\nWhat is Workflow?How does retrying work?What control flow patterns are there?How do directives work?How do I build an AI agent?\n\nTip: You can open and close chat with `⌘I`\n\n0 / 1000",
  "metadata": {
    "og:image:height": "628",
    "twitter:image:width": "1200",
    "twitter:image:height": "628",
    "twitter:image:type": "image/png",
    "og:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "twitter:title": "fetch-in-workflow",
    "og:image:type": "image/png",
    "viewport": "width=device-width, initial-scale=1",
    "twitter:card": "summary_large_image",
    "og:image:width": "1200",
    "ogTitle": "fetch-in-workflow",
    "next-size-adjust": "",
    "language": "en",
    "og:title": "fetch-in-workflow",
    "title": "fetch-in-workflow",
    "ogImage": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "twitter:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "favicon": "https://useworkflow.dev/favicon.ico?favicon.e7ce0d1c.ico",
    "scrapeId": "019bf2d4-569c-75d7-940f-3159229ab93c",
    "sourceURL": "https://useworkflow.dev/docs/errors/fetch-in-workflow",
    "url": "https://useworkflow.dev/docs/errors/fetch-in-workflow",
    "statusCode": 200,
    "contentType": "text/html; charset=utf-8",
    "proxyUsed": "basic",
    "cacheState": "hit",
    "cachedAt": "2026-01-24T22:00:43.321Z",
    "creditsUsed": 1
  }
}