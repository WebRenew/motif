{
  "markdown": "[Vercel](https://vercel.com/) Slash [Workflow DevKit LogoWorkflow](https://useworkflow.dev/)\n\n- [Docs](https://useworkflow.dev/docs)\n- [Examples](https://github.com/vercel/workflow-examples)\n\n[X](https://x.com/workflowdevkit) [GitHub](https://github.com/vercel/workflow) Search... `⌘K`Ask AI\n\nAsk AI\n\nSearch... `⌘K`\n\n[Getting Started](https://useworkflow.dev/docs/getting-started)\n\n- [Next.js](https://useworkflow.dev/docs/getting-started/next)\n- [Vite](https://useworkflow.dev/docs/getting-started/vite)\n- [Astro](https://useworkflow.dev/docs/getting-started/astro)\n- [Express](https://useworkflow.dev/docs/getting-started/express)\n- [Fastify](https://useworkflow.dev/docs/getting-started/fastify)\n- [Hono](https://useworkflow.dev/docs/getting-started/hono)\n- [Nitro](https://useworkflow.dev/docs/getting-started/nitro)\n- [Nuxt](https://useworkflow.dev/docs/getting-started/nuxt)\n- [SvelteKit](https://useworkflow.dev/docs/getting-started/sveltekit)\n\n[Foundations](https://useworkflow.dev/docs/foundations)\n\n- [Workflows and Steps](https://useworkflow.dev/docs/foundations/workflows-and-steps)\n- [Starting Workflows](https://useworkflow.dev/docs/foundations/starting-workflows)\n- [Control Flow Patterns](https://useworkflow.dev/docs/foundations/control-flow-patterns)\n- [Errors & Retrying](https://useworkflow.dev/docs/foundations/errors-and-retries)\n- [Hooks & Webhooks](https://useworkflow.dev/docs/foundations/hooks)\n- [Streaming](https://useworkflow.dev/docs/foundations/streaming)\n- [Serialization](https://useworkflow.dev/docs/foundations/serialization)\n- [Idempotency](https://useworkflow.dev/docs/foundations/idempotency)\n\nHow it works\n\n[Observability](https://useworkflow.dev/docs/observability)\n\nAI Agents\n\n- [Building Durable AI Agents](https://useworkflow.dev/docs/ai)\n- [Streaming Updates from Tools](https://useworkflow.dev/docs/ai/streaming-updates-from-tools)\n- [Resumable Streams](https://useworkflow.dev/docs/ai/resumable-streams)\n- [Sleep, Suspense, and Scheduling](https://useworkflow.dev/docs/ai/sleep-and-delays)\n- [Human-in-the-Loop](https://useworkflow.dev/docs/ai/human-in-the-loop)\n- [Patterns for Defining Tools](https://useworkflow.dev/docs/ai/defining-tools)\n- [Chat Session Modeling](https://useworkflow.dev/docs/ai/chat-session-modeling)\n\n[Deploying](https://useworkflow.dev/docs/deploying)\n\n[Errors](https://useworkflow.dev/docs/errors)\n\n[API Reference](https://useworkflow.dev/docs/api-reference)\n\nFramework IntegrationsWhat You'll Build\n\nHow it works\n\n# Framework Integrations\n\n**For users:** If you just want to use Workflow DevKit with an existing framework, check out the [Getting Started](https://useworkflow.dev/docs/getting-started) guide instead. This page is for framework authors who want to integrate Workflow DevKit with their framework or runtime.\n\nThis guide walks you through building a framework integration for Workflow DevKit using Bun as a concrete example. The same principles apply to any JavaScript runtime (Node.js, Deno, Cloudflare Workers, etc.).\n\n**Prerequisites:** Before building a framework integration, we recommend reading [How the Directives Work](https://useworkflow.dev/docs/how-it-works/code-transform) to understand the transformation system that powers Workflow DevKit.\n\n## [What You'll Build](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#what-youll-build)\n\nA framework integration has two main components:\n\n1. **Build-time**: Generate workflow handler files (`flow.js`, `step.js`, `webhook.js`)\n2. **Runtime**: Expose these handlers as HTTP endpoints in your application server\n\nSource Code\n\n'use workflow'\n\nWorkflow Builder\n\nSWC Transform\n\nStep Mode\n\nWorkflow Mode\n\nClient Mode\n\nGenerated Handlers\n\nstep.js\n\nGenerated Handlers\n\nflow.js\n\nGenerated Handlers\n\nwebhook.js\n\nUsed by framework loader\n\nHTTP Server\n\n(Your Runtime)\n\nThe purple boxes are what you implement—everything else is provided by Workflow DevKit.\n\n## [Example: Bun Integration](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#example-bun-integration)\n\nLet's build a complete integration for Bun. Bun is unique because it serves as both a runtime (needs code transformations) and a framework (provides `Bun.serve()` for HTTP routing).\n\nA working example can be [found here](https://github.com/vercel/workflow-examples/tree/main/custom-adapter). For a production-ready reference, see the [Next.js integration](https://github.com/vercel/workflow/tree/main/packages/next).\n\n### [Step 1: Generate Handler Files](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#step-1-generate-handler-files)\n\nUse the `workflow` CLI to generate the handler bundles. The CLI scans your `workflows/` directory and creates `flow.js`, `step.js`, and `webhook.js`.\n\npackage.json\n\n```\n\n```\n\n**For production integrations:** Instead of using the CLI, extend the `BaseBuilder` class directly in your framework plugin. This gives you control over file watching, custom output paths, and framework-specific hooks. See the [Next.js plugin](https://github.com/vercel/workflow/tree/main/packages/next) for an example.\n\n**What gets generated:**\n\n- `/.well-known/workflow/v1/flow.js` \\- Handles workflow execution (workflow mode transform)\n- `/.well-known/workflow/v1/step.js` \\- Handles step execution (step mode transform)\n- `/.well-known/workflow/v1/webhook.js` \\- Handles webhook delivery\n\nEach file exports a `POST` function that accepts Web standard `Request` objects.\n\n### [Step 2: Add Client Mode Transform (Optional)](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#step-2-add-client-mode-transform-optional)\n\nClient mode transforms your application code to provide better DX. Add a Bun plugin to apply this transformation at runtime:\n\nworkflow-plugin.ts\n\n```\n\n```\n\nActivate the plugin in `bunfig.toml`:\n\nbunfig.toml\n\n```\n\n```\n\n**What this does:**\n\n- Attaches workflow IDs to functions for use with `start()`\n- Provides TypeScript type safety\n- Prevents accidental direct execution of workflows\n\n**Why optional?** Without client mode, you can still use workflows by manually constructing IDs or referencing the build manifest.\n\n### [Step 3: Expose HTTP Endpoints](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#step-3-expose-http-endpoints)\n\nWire up the generated handlers to HTTP endpoints using `Bun.serve()`:\n\nserver.ts\n\n```\n\n```\n\n**That's it!** Your Bun integration is complete.\n\n## [Understanding the Endpoints](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#understanding-the-endpoints)\n\nYour integration must expose three HTTP endpoints. The generated handlers manage all protocol details—you just route requests.\n\n### [Workflow Endpoint](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#workflow-endpoint)\n\n**Route:**`POST /.well-known/workflow/v1/flow`\n\nExecutes workflow orchestration logic. The workflow function is \"rendered\" multiple times during execution—each time it progresses until it encounters the next step.\n\n**Called when:**\n\n- Starting a new workflow\n- Resuming after a step completes\n- Resuming after a webhook or hook triggers\n- Recovering from failures\n\n### [Step Endpoint](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#step-endpoint)\n\n**Route:**`POST /.well-known/workflow/v1/step`\n\nExecutes individual atomic operations within workflows. Each step runs exactly once per execution (unless retried due to failure). Steps have full runtime access (Node.js APIs, file system, databases, etc.).\n\n### [Webhook Endpoint](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#webhook-endpoint)\n\n**Route:**`POST /.well-known/workflow/v1/webhook/:token`\n\nDelivers webhook data to running workflows via [`createWebhook()`](https://useworkflow.dev/docs/api-reference/workflow/create-webhook). The `:token` parameter identifies which workflow run should receive the data.\n\nThe webhook file structure varies by framework. Next.js generates `webhook/[token]/route.js` to leverage App Router's dynamic routing, while other frameworks generate a single `webhook.js` handler.\n\n## [Adapting to Other Frameworks](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#adapting-to-other-frameworks)\n\nThe Bun example demonstrates the core pattern. To adapt for your framework:\n\n### [Build-Time](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#build-time)\n\n**Option 1: Use the CLI** (simplest)\n\n```\nworkflow build\n```\n\nThis will default to scanning the `./workflows` top-level directory for workflow files, and will output bundled files directly into your working directory.\n\n**Option 2: Extend `BaseBuilder`** (recommended)\n\n```\nimport { BaseBuilder } from \"@workflow/cli/dist/lib/builders/base-builder\";\n\nclass MyFrameworkBuilder extends BaseBuilder {\n  constructor(options) {\n    super({\n      dirs: [\"workflows\"],\n      workingDir: options.rootDir,\n      watch: options.dev,\n    });\n  }\n\n  override async build(): Promise<void> {\n    const inputFiles = await this.getInputFiles();\n\n    await this.createWorkflowsBundle({\n      outfile: \"/path/to/.well-known/workflow/v1/flow.js\",\n      format: \"esm\",\n      inputFiles,\n    });\n\n    await this.createStepsBundle({\n      outfile: \"/path/to/.well-known/workflow/v1/step.js\",\n      format: \"esm\",\n      inputFiles,\n    });\n\n    await this.createWebhookBundle({\n      outfile: \"/path/to/.well-known/workflow/v1/webhook.js\",\n    });\n  }\n}\n```\n\nIf your framework supports virtual server routes and dev mode watching, make sure to adapt accordingly. Please open a PR to the Workflow DevKit if the base builder class is missing necessary functionality.\n\nHook into your framework's build:\n\npseudocode.ts\n\n```\n\n```\n\n### [Runtime (Client Mode)](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#runtime-client-mode)\n\nAdd a loader/plugin for your bundler:\n\n**Rollup/Vite:**\n\n```\nexport function workflowPlugin() {\n  return {\n    name: \"workflow-client-transform\",\n    async transform(code, id) {\n      if (!code.match(/(use step|use workflow)/)) return null;\n\n      const result = await transform(code, {\n        filename: id,\n        jsc: {\n          experimental: {\n            plugins: [[require.resolve(\"@workflow/swc-plugin\"), { mode: \"client\" }]],\n          },\n        },\n      });\n\n      return { code: result.code, map: result.map };\n    },\n  };\n}\n```\n\n**Webpack:**\n\n```\nmodule.exports = {\n  module: {\n    rules: [\\\n      {\\\n        test: /\\.(ts|tsx|js|jsx)$/,\\\n        use: \"workflow-client-loader\", // Similar implementation\\\n      },\\\n    ],\n  },\n};\n```\n\n### [HTTP Server](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#http-server)\n\nRoute the three endpoints to the generated handlers. The exact implementation depends on your framework's routing API.\n\nIn the bun example above, we left routing to the user. Essentially, the user has to serve routes like this:\n\nserver.ts\n\n```\n\n```\n\nProduction framework integrations should handle this routing in the plugin instead of leaving it to the user, and this depends on each framework's unique implementaiton.\nCheck the Workflow DevKit source code for examples of production framework implementations.\nIn the future, the Workflow DevKit will emit more routes under the `.well-known/workflow` namespace.\n\n## [Security](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#security)\n\n**How are these HTTP endpoints secured?**\n\nSecurity is handled by the **world abstraction** you're using:\n\n**Vercel (`@workflow/world-vercel`):**\n\n- Vercel Queue will support private invoke, making routes inaccessible from the public internet\n- Handlers receive only a message ID that must be retrieved from Vercel's backend\n- Impossible to craft custom payloads without valid queue-issued message IDs\n\n**Custom implementations:**\n\n- Implement authentication via framework middleware\n- Use API keys, JWT validation, or other auth schemes\n- Network-level security (VPCs, private networks, firewall rules)\n- Rate limiting and request validation\n\nLearn more about [world abstractions](https://useworkflow.dev/docs/deploying/world).\n\n## [Testing Your Integration](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#testing-your-integration)\n\n### [1\\. Test Build Output](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#1-test-build-output)\n\nCreate a test workflow:\n\nworkflows/test.ts\n\n```\n\n```\n\nRun your build and verify:\n\n- `.well-known/workflow/v1/flow.js` exists\n- `.well-known/workflow/v1/step.js` exists\n- `.well-known/workflow/v1/webhook.js` exists\n\n### [2\\. Test HTTP Endpoints](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#2-test-http-endpoints)\n\nStart your server and verify routes respond:\n\n```\ncurl -X POST http://localhost:3000/.well-known/workflow/v1/flow\ncurl -X POST http://localhost:3000/.well-known/workflow/v1/step\ncurl -X POST http://localhost:3000/.well-known/workflow/v1/webhook/test\n```\n\n(Should respond but not trigger meaningful code without authentication/proper workflow run)\n\n### [3\\. Run a Workflow End-to-End](https://useworkflow.dev/docs/how-it-works/framework-integrations\\#3-run-a-workflow-end-to-end)\n\n```\nimport { start } from \"workflow/api\";\nimport { handleUserSignup } from \"./workflows/test\";\n\nconst run = await start(handleUserSignup, [\"test@example.com\"]);\nconsole.log(\"Workflow started:\", run.runId);\n```\n\n[How the Directives Work\\\\\n\\\\\nPrevious Page](https://useworkflow.dev/docs/how-it-works/code-transform) [Event Sourcing\\\\\n\\\\\nNext Page](https://useworkflow.dev/docs/how-it-works/event-sourcing)\n\nOn this page\n\n[What You'll Build](https://useworkflow.dev/docs/how-it-works/framework-integrations#what-youll-build) [Example: Bun Integration](https://useworkflow.dev/docs/how-it-works/framework-integrations#example-bun-integration) [Step 1: Generate Handler Files](https://useworkflow.dev/docs/how-it-works/framework-integrations#step-1-generate-handler-files) [Step 2: Add Client Mode Transform (Optional)](https://useworkflow.dev/docs/how-it-works/framework-integrations#step-2-add-client-mode-transform-optional) [Step 3: Expose HTTP Endpoints](https://useworkflow.dev/docs/how-it-works/framework-integrations#step-3-expose-http-endpoints) [Understanding the Endpoints](https://useworkflow.dev/docs/how-it-works/framework-integrations#understanding-the-endpoints) [Workflow Endpoint](https://useworkflow.dev/docs/how-it-works/framework-integrations#workflow-endpoint) [Step Endpoint](https://useworkflow.dev/docs/how-it-works/framework-integrations#step-endpoint) [Webhook Endpoint](https://useworkflow.dev/docs/how-it-works/framework-integrations#webhook-endpoint) [Adapting to Other Frameworks](https://useworkflow.dev/docs/how-it-works/framework-integrations#adapting-to-other-frameworks) [Build-Time](https://useworkflow.dev/docs/how-it-works/framework-integrations#build-time) [Runtime (Client Mode)](https://useworkflow.dev/docs/how-it-works/framework-integrations#runtime-client-mode) [HTTP Server](https://useworkflow.dev/docs/how-it-works/framework-integrations#http-server) [Security](https://useworkflow.dev/docs/how-it-works/framework-integrations#security) [Testing Your Integration](https://useworkflow.dev/docs/how-it-works/framework-integrations#testing-your-integration) [1\\. Test Build Output](https://useworkflow.dev/docs/how-it-works/framework-integrations#1-test-build-output) [2\\. Test HTTP Endpoints](https://useworkflow.dev/docs/how-it-works/framework-integrations#2-test-http-endpoints) [3\\. Run a Workflow End-to-End](https://useworkflow.dev/docs/how-it-works/framework-integrations#3-run-a-workflow-end-to-end)\n\n[GitHubEdit this page on GitHub](https://github.com/vercel/workflow/edit/main/content/docs/how-it-works/framework-integrations.mdx) Scroll to topGive feedbackCopy pageAsk AI about this pageOpen in chat\n\n## Chat\n\nWhat is Workflow?How does retrying work?What control flow patterns are there?How do directives work?How do I build an AI agent?\n\nTip: You can open and close chat with `⌘I`\n\n0 / 1000",
  "metadata": {
    "og:image:height": "628",
    "twitter:title": "Framework Integrations",
    "title": "Framework Integrations",
    "twitter:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "viewport": "width=device-width, initial-scale=1",
    "twitter:card": "summary_large_image",
    "og:image:type": "image/png",
    "twitter:image:width": "1200",
    "language": "en",
    "twitter:image:type": "image/png",
    "next-size-adjust": "",
    "og:title": "Framework Integrations",
    "ogImage": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "og:image:width": "1200",
    "twitter:image:height": "628",
    "og:image": "https://useworkflow.dev/opengraph-image.png?opengraph-image.f38670ff.png",
    "ogTitle": "Framework Integrations",
    "favicon": "https://useworkflow.dev/favicon.ico?favicon.e7ce0d1c.ico",
    "scrapeId": "019bf2d4-569c-75d7-940f-46df8393bcf4",
    "sourceURL": "https://useworkflow.dev/docs/how-it-works/framework-integrations",
    "url": "https://useworkflow.dev/docs/how-it-works/framework-integrations",
    "statusCode": 200,
    "contentType": "text/html; charset=utf-8",
    "proxyUsed": "basic",
    "cacheState": "hit",
    "cachedAt": "2026-01-25T00:05:14.523Z",
    "creditsUsed": 1
  }
}